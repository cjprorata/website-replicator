(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[899],{65471:function(e,t,n){"use strict";var r=n(67294);function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var i=r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.979 6.647L.646 11.979l.668.668 5.333-5.333 5.332 5.333.668-.668-5.333-5.332 5.333-5.333-.668-.668L6.647 5.98 1.314.646l-.668.668L5.98 6.647z",fill:"#21272C"});t.Z=function(e){var t=e.title,n=e.titleId,o=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,["title","titleId"]);return r.createElement("svg",_extends({width:13,height:13,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},o),t?r.createElement("title",{id:n},t):null,i)}},55505:function(e,t,n){"use strict";var r=n(72253),i=n(85893),o=n(67294),a=n(77705),s=n(65471),l=n(67249),c=n.n(l);t.Z=function(e){var t=e.title,n=e.children,l=e.close,d=(0,o.useId)(),u=(0,o.useId)();return(0,i.jsx)(a.Z,{returnFocus:!0,lockProps:(0,r._)({"aria-labelledby":d},n&&{"aria-describedby":u}),clickOutsideClose:l,children:(0,i.jsx)("div",{className:c().modal,"data-testid":"error-modal",children:(0,i.jsxs)("div",{className:c().content,children:[(0,i.jsx)("button",{className:c().closeIcon,onClick:l,children:(0,i.jsx)(s.Z,{})}),(0,i.jsx)("div",{id:d,className:c().title,children:void 0===t?"Something went wrong.":t}),n&&(0,i.jsx)("div",{id:u,className:c().message,children:n}),(0,i.jsx)("button",{className:c().closeButton,onClick:l,children:"Close"})]})})})}},38394:function(e,t,n){"use strict";var r=n(24043),i=n(85893),o=n(67294),a=n(94184),s=n.n(a),l=n(69135),c=n.n(l);t.Z=function(e){var t=e.delay,n=void 0===t?0:t,a=e.size,l=e.className,d=(0,r._)((0,o.useState)(!!n),2),u=d[0],v=d[1],f=s()(c().root,l),_=s()(c().spinner,c()[void 0===a?"large":a]);return((0,o.useEffect)(function(){var e=setTimeout(function(){return v(!1)},n);return function(){return clearTimeout(e)}},[n,v]),u)?null:(0,i.jsx)("div",{className:f,"aria-label":"Content is loading",children:(0,i.jsx)("div",{className:_})})}},37298:function(e,t,n){"use strict";var r=n(72253),i=n(14932),o=n(85893),a=n(67294),s=n(94184),l=n.n(s),c=n(96645),d=n.n(c),u=(0,a.memo)((0,a.forwardRef)(function(e,t){var n=e.className,a=e.defer,s=e.lazyLoadScreens,c=e.targetingNative,u=e.targetingPos,v=e.format,f=e.sizesAt0,_=e.sizesAt768,m=e.sizesAt976,p=e.sizesAt1010,g=e.logoFormat,A=e.fontScale,h={};void 0!==a&&a&&(h.defer="1"),g&&(h["data-logo-format"]=g),void 0!==p&&(h["sizes-at-1010"]=p),void 0!==m&&(h["sizes-at-976"]=m),void 0!==_&&(h["sizes-at-768"]=_);var S=A&&1/A;return(0,o.jsx)("gpt-ad",(0,i._)((0,r._)({ref:t,class:l()(d().root,n),"lazy-load":s,format:void 0===v?"injector":v,"sizes-at-0":f,"targeting-pos":u,"targeting-native":c},h),{style:S&&{zoom:S}}))}));u.displayName="GptAd",t.Z=u},73874:function(e,t,n){"use strict";var r=n(82729),i=n(85893),o=n(35283),a=n(56805),s=n.n(a),l=n(22553);function _templateObject(){var e=(0,r._)(["\n  fragment articleContext on Article {\n    authors {\n      url\n      displayName\n    }\n    ... on BlogArticle {\n      authorContext\n    }\n    ... on MagazineArticle {\n      authorContext\n    }\n  }\n"]);return _templateObject=function(){return e},e}var ArticleContextModule=function(){var e=(0,l.$Y)(),t=e.authorContext,n=e.authors;return t?(0,i.jsx)("section",{className:s().root,"data-event-module":"author context",children:(0,i.jsxs)("div",{className:s().text,children:[(0,i.jsx)("a",{className:s().firstAuthorName,href:n[0].url,"data-event-element":"author",children:n[0].displayName}),(0,i.jsx)("p",{className:s().context,dangerouslySetInnerHTML:{__html:t}})]})}):(0,i.jsx)(i.Fragment,{})};ArticleContextModule.fragment=(0,o.Ps)(_templateObject()),t.Z=ArticleContextModule},22553:function(e,t,n){"use strict";n.d(t,{$Y:function(){return useArticleContext},sc:function(){return ArticleContextProvider}});var r=n(47702),i=n(82729),o=n(85893),a=n(35283),s=n(67294),l=n(41006),c=n(73874);function _templateObject(){var e=(0,i._)(["\n  ","\n  ","\n\n  fragment articleContextProvider on Article {\n    ...paywallContextArticle\n\n    __typename\n    id\n    preview\n    datePublished\n    primaryCategory {\n      ... on Category {\n        slug\n      }\n      ... on Channel {\n        slug\n      }\n      ... on EditorialProject {\n        slug\n      }\n    }\n    primaryChannel {\n      slug\n    }\n    hasMeter\n    categories {\n      slug\n    }\n    authors {\n      displayName\n      url\n      slug\n    }\n    editorialProject {\n      slug\n    }\n    ...articleContext\n  }\n"]);return _templateObject=function(){return e},e}var d=(0,s.createContext)({__typename:null,articleId:"",previewParam:"",primaryCategorySlug:"",primaryChannelSlug:"",datePublished:null,randomNumber:0,hasMeter:!1,categories:[],authorContext:"",authors:[],editorialProject:null}),ArticleContextProvider=function(e){var t,n,i=e.children,a=(0,r._)(e,["children"]);return(0,o.jsx)(d.Provider,{value:{__typename:a.__typename,articleId:a.id.split(":")[1],previewParam:a.preview,primaryCategorySlug:(null===(t=a.primaryCategory)||void 0===t?void 0:t.slug)||"",primaryChannelSlug:(null===(n=a.primaryChannel)||void 0===n?void 0:n.slug)||"",datePublished:a.datePublished,randomNumber:Math.random(),hasMeter:a.hasMeter,categories:a.categories,authorContext:a.authorContext||"",authors:a.authors,editorialProject:a.editorialProject},children:(0,o.jsx)(l.D3,{article:a,children:i})})};ArticleContextProvider.fragment=(0,a.Ps)(_templateObject(),l.D3.fragment,c.Z.fragment);var useArticleContext=function(){var e=(0,s.useContext)(d);if(void 0===e)throw Error("useContext must be used within a Provider");return e}},61178:function(e,t,n){"use strict";n.d(t,{qX:function(){return SavedArticlesContextProvider},ZP:function(){return utils_useSavedArticle}});var r=n(11010),i=n(72253),o=n(14932),a=n(24043),s=n(82729),l=n(248),c=n(20414),d=n(85893),u=n(67294),v=n(11752),f=n.n(v),_=n(11163),m=n(49319),p=n(76163),g=n(8698),A=n(52285),h=n(79296),S=n(8),y=n(94184),C=n.n(y),w=n(15303),x=n.n(w),E=n(77705),b=n(38394),O=n(28855),j=n.n(O),M=f()().publicRuntimeConfig.ACCOUNTS_FRONTEND_URL,components_LoginModal=function(e){var t=e.src,n=e.title,r=e.close,i=(0,a._)((0,u.useState)(!1),2),o=i[0],s=i[1],l=(0,u.useRef)(null);return(0,u.useEffect)(function(){var e=l.current;return x().iframeResizer({log:!1,messageCallback:function(e){var t=e.message.type;"SUCCESS"===t?location.reload():"CLOSE"===t&&r()}},e),function(){var t;return null===(t=e.iFrameResizer)||void 0===t?void 0:t.removeListeners()}},[r]),(0,d.jsx)(E.Z,{clickOutsideClose:r,children:(0,d.jsxs)("div",{className:j().modal,"data-testid":"login-modal",children:[!o&&(0,d.jsx)(b.Z,{className:j().spinner,size:"xlarge"}),(0,d.jsx)("iframe",{ref:l,className:C()(j().iframe,!o&&j().iframeHidden),src:void 0===t?"".concat(M,"/login/modal/"):t,title:void 0===n?"Accounts Modal":n,onLoad:function(){return s(!0)}})]})})},R=n(55505);function _templateObject(){var e=(0,s._)(["\n  query SavedArticleIds($first: Int!) {\n    savedArticleIds(first: $first) {\n      edges {\n        node {\n          id\n        }\n      }\n    }\n  }\n"]);return _templateObject=function(){return e},e}function _templateObject1(){var e=(0,s._)(["\n  mutation SaveArticle($id: ID!) {\n    saveArticle(id: $id)\n  }\n"]);return _templateObject1=function(){return e},e}function _templateObject2(){var e=(0,s._)(["\n  mutation DeleteSavedArticles($ids: [ID!]!) {\n    deleteSavedArticles(ids: $ids)\n  }\n"]);return _templateObject2=function(){return e},e}var P=f()().publicRuntimeConfig.ACCOUNTS_FRONTEND_URL,D=(0,p.Ps)(_templateObject()),L=(0,p.Ps)(_templateObject1()),N=(0,p.Ps)(_templateObject2()),I={isAuthenticated:!1,shouldShowLogin:!1,errorAction:null,isWebView:!1,toAdd:new Set,adding:new Set,toRemove:new Set,removing:new Set,savedArticleIds:new Set},T=(0,u.createContext)((0,o._)((0,i._)({},I),{dispatch:function(){return I}})),savedArticlesReducer=function(e,t){switch(t.type){case"ADD":return(0,o._)((0,i._)({},e),{toAdd:new Set((0,l._)(Array.from(e.toAdd)).concat((0,l._)(t.ids))),shouldShowLogin:!e.isAuthenticated});case"ADD_FETCH":return(0,o._)((0,i._)({},e),{toAdd:new Set(Array.from(e.toAdd).filter(function(e){return!t.ids.includes(e)})),adding:new Set((0,l._)(Array.from(e.adding)).concat((0,l._)(t.ids)))});case"ADD_SUCCESS":return(0,o._)((0,i._)({},e),{adding:new Set(Array.from(e.adding).filter(function(e){return!t.ids.includes(e)})),savedArticleIds:new Set((0,l._)(Array.from(e.savedArticleIds)).concat((0,l._)(t.ids)))});case"ADD_ERROR":var n,r,a;return t.error instanceof m.C&&(null===(a=t.error)||void 0===a?void 0:null===(r=a.message)||void 0===r?void 0:null===(n=r.toLowerCase())||void 0===n?void 0:n.includes("bad request"))?(0,o._)((0,i._)({},e),{isAuthenticated:!1,shouldShowLogin:!0,errorAction:null,toAdd:new Set((0,l._)(Array.from(e.toAdd)).concat((0,l._)(Array.from(e.adding)))),adding:new Set}):(0,o._)((0,i._)({},e),{errorAction:"save",adding:new Set(Array.from(e.adding).filter(function(e){return e!==t.id}))});case"REMOVE":return(0,o._)((0,i._)({},e),{toRemove:new Set((0,l._)(Array.from(e.toRemove)).concat((0,l._)(t.ids)))});case"REMOVE_FETCH":return(0,o._)((0,i._)({},e),{toRemove:new Set(Array.from(e.toRemove).filter(function(e){return!t.ids.includes(e)})),removing:new Set((0,l._)(Array.from(e.removing)).concat((0,l._)(t.ids)))});case"REMOVE_SUCCESS":return(0,o._)((0,i._)({},e),{removing:new Set(Array.from(e.removing).filter(function(e){return!t.ids.includes(e)})),savedArticleIds:new Set(Array.from(e.savedArticleIds).filter(function(e){return!t.ids.includes(e)}))});case"REMOVE_ERROR":return(0,o._)((0,i._)({},e),{errorAction:"remove",removing:new Set(Array.from(e.removing).filter(function(e){return!t.ids.includes(e)}))});case"TOGGLE":return(0,i._)({},e,e.savedArticleIds.has(t.id)?{toRemove:new Set((0,l._)(Array.from(e.toRemove)).concat([t.id]))}:{toAdd:new Set((0,l._)(Array.from(e.toAdd)).concat([t.id])),shouldShowLogin:!e.isAuthenticated});case"UPDATE_FROM_APP":return(0,o._)((0,i._)({},e),{savedArticleIds:new Set((0,l._)(Array.from(e.savedArticleIds).filter(function(e){return!t.deleted.includes(e)})).concat((0,l._)(t.saved)))});case"CLOSE_MODAL":return(0,o._)((0,i._)({},e),{errorAction:null,shouldShowLogin:!1,toAdd:new Set});default:return e}},SavedArticlesContextProvider=function(e){var t=e.children,n=(0,g.aC)().isLoggedIn,s=(0,_.useRouter)().asPath,v=(0,a._)((0,u.useReducer)(savedArticlesReducer,(0,o._)((0,i._)({},I),{isAuthenticated:!!n,isWebView:s.startsWith("/app/")})),2),f=v[0],m=v[1],A=f.isAuthenticated,h=f.shouldShowLogin,y=f.errorAction,C=f.isWebView,w=f.toAdd,x=f.adding,E=f.toRemove,b=f.savedArticleIds,O=(0,a._)((0,p.aM)({query:D,requestPolicy:"cache-and-network",pause:!0,variables:{first:1e3}}),2),j=O[0],M=j.data,z=j.fetching,k=O[1];(0,u.useEffect)(function(){n&&k()},[n,k]),(0,u.useEffect)(function(){!z&&M&&m({type:"ADD_SUCCESS",ids:M.savedArticleIds.edges.map(function(e){return e.node.id.split(":")[1]})})},[M,z]);var V=(0,S.ZP)("SAVED_ARTICLES_UPDATE",function(e){var t=e.reduce(function(e,t){var n=(0,a._)((0,S.Pe)(t),2),r=n[0],o=n[1];return(0,i._)({},e,"save"===r&&{saved:(0,l._)(e.saved).concat([o])},"delete"===r&&{deleted:(0,l._)(e.deleted).concat([o])})},{saved:[],deleted:[]});m({type:"UPDATE_FROM_APP",saved:t.saved,deleted:t.deleted})}).postMessage,F=(0,a._)((0,p.Db)(L),2)[1];(0,u.useEffect)(function(){if(A&&0!==w.size){var e;m({type:"ADD_FETCH",ids:Array.from(w)}),w.forEach((e=(0,r._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,F({id:e})];case 1:if(n=(t=i.sent()).data,r=t.error,(null==n?void 0:n.saveArticle)===!0)m({type:"ADD_SUCCESS",ids:[e]}),V("save:".concat(e));else throw r;return[3,3];case 2:return m({type:"ADD_ERROR",id:e,error:i.sent()}),[3,3];case 3:return[2]}})}),function(t){return e.apply(this,arguments)}))}},[A,w,F,V]);var U=(0,a._)((0,p.Db)(N),2)[1];(0,u.useEffect)(function(){A&&0!==E.size&&(0,r._)(function(){var e,t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:m({type:"REMOVE_FETCH",ids:e=Array.from(E)}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,U({ids:e})];case 2:if(n=(t=i.sent()).data,r=t.error,(null==n?void 0:n.deleteSavedArticles)===!0)m({type:"REMOVE_SUCCESS",ids:e}),V("delete:".concat(e[e.length-1]));else throw r;return[3,4];case 3:return i.sent(),m({type:"REMOVE_ERROR",ids:e}),[3,4];case 4:return[2]}})})()},[A,E,U,V]),(0,u.useEffect)(function(){var e=getArticleToSave();if(!A||!e||y||w.has(e)||x.has(e)||b.has(e)){if(h&&!e){var t=Array.from(w);setArticleToSave(t[t.length-1])}else e&&removeArticleToSave()}else m({type:"ADD",ids:[e]})},[A,y,w,x,b,h]),(0,u.useEffect)(function(){C&&h&&((0,S.k8)("open_save_article_modal"),m({type:"CLOSE_MODAL"}))},[C,h]);var Z=(0,u.useCallback)(function(){return m({type:"CLOSE_MODAL"})},[]);return(0,d.jsxs)(T.Provider,{value:(0,o._)((0,i._)({},f),{dispatch:m}),children:[t,!C&&h&&(0,d.jsx)(components_LoginModal,{src:"".concat(P,"/login/save-story/modal/"),title:"Save Story Accounts Modal",close:Z}),!!y&&(0,d.jsxs)(R.Z,{close:Z,children:["We’re unable to ",y," this story at this time."]})]})},getArticleToSave=function(){return sessionStorage.getItem("save-story")},setArticleToSave=function(e){sessionStorage.setItem("save-story",e)},removeArticleToSave=function(){sessionStorage.removeItem("save-story")},utils_useSavedArticle=function(e){var t=e.id,n=e.url,r=(0,u.useContext)(T),i=r.isAuthenticated,o=r.adding,s=r.removing,l=r.savedArticleIds,c=r.dispatch,d=(0,u.useContext)(A.m),v=(0,a._)((0,u.useState)(!1),2),f=v[0],_=v[1],m=(0,u.useRef)(null),p=o.has(t),g=s.has(t),S=l.has(t),y=(0,u.useCallback)(function(){(0,h.z6)().push({event:"Article Save","gtm.element":m.current,savedArticleId:t,isSaved:S})},[t,S]),C=(0,u.useCallback)(function(){c({type:"ADD",ids:[t]}),y()},[c,t,y]),w=(0,u.useCallback)(function(){c({type:"REMOVE",ids:[t]}),y()},[c,t,y]),x=(0,u.useCallback)(function(){c({type:"TOGGLE",id:t}),y()},[c,t,y]);return(0,u.useEffect)(function(){!f&&i&&t===getArticleToSave()&&((0,h.z6)().push({event:"saved stories",category:d||"not story page",action:"save story - login",label:n,"gtm.element":m.current}),_(!0))},[f,i,t,d,n]),{isSaved:(p||S)&&!g,isFetching:p||g,saveArticle:C,deleteSavedArticle:w,toggleSavedArticle:x,buttonRef:m}}},8:function(e,t,n){"use strict";n.d(t,{Pe:function(){return splitMessage},k8:function(){return postWebViewMessage}});var r=n(24043),i=n(67294),postWebViewMessage=function(e){var t;"function"==typeof(null===(t=window.ReactNativeWebView)||void 0===t?void 0:t.postMessage)&&window.ReactNativeWebView.postMessage(e)};t.ZP=function(e,t){var n=(0,r._)((0,i.useState)(null),2),o=n[0],a=n[1];return(0,i.useEffect)(function(){var receiveAppData=function(e){t&&t(e.detail),a(e.detail)};return document.addEventListener(e,receiveAppData),function(){return document.removeEventListener(e,receiveAppData)}},[e,t]),{data:o,postMessage:(0,i.useCallback)(function(e){return postWebViewMessage(e)},[])}};var splitMessage=function(e){return e.split(":")}},67249:function(e){e.exports={modal:"ErrorModal_modal__5VGTI",closeIcon:"ErrorModal_closeIcon__iRI90",title:"ErrorModal_title__UonCy",message:"ErrorModal_message__QREbW",closeButton:"ErrorModal_closeButton__nmuOz"}},28855:function(e){e.exports={modal:"LoginModal_modal__Swvnv",spinner:"LoginModal_spinner__m0AjK",iframe:"LoginModal_iframe__FDChL",iframeHidden:"LoginModal_iframeHidden__MGyeE"}},69135:function(e){e.exports={root:"Spinner_root__4OdCt",spinner:"Spinner_spinner__cCYMj",spin:"Spinner_spin__T2kpd",small:"Spinner_small__mvL0z",medium:"Spinner_medium__prHAi",large:"Spinner_large__IqFZi",xlarge:"Spinner_xlarge__1Vqta"}},96645:function(e){e.exports={root:"GptAd_root__pAvcS",allowOverflow:"GptAd_allowOverflow__3B6tW"}},56805:function(e){e.exports={root:"ArticleContextModule_root__Ve2Ml",text:"ArticleContextModule_text__og353",firstAuthorName:"ArticleContextModule_firstAuthorName__GUpYH"}}}]);